<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Visualization</title>
    <link type="stylesheet" href="style.css">
  </head>
  <body>
    <div id="container"></div>
  </body>
  <style>
    body{
    background-color: gray
  }
  </style>
  <script type="module">
    import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

    // Specify the chart dimensions and margins.
    const width = 1800;
    const height = 900;
    const marginTop = 30;
    const marginRight = 0;
    const marginBottom = 30;
    const marginLeft = 80;

    d3.json(
      "https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/GDP-data.json?authuser=0"
    ).then((response) => {
      const data = response.data;

      // Sort the data based on frequency in descending order.

      // Declare the x (horizontal position) scale.
      const x = d3
        .scaleBand()
        .domain(data.map((d) => d[0])) // Swap index 1 with index 0
        .range([marginLeft, width - marginRight])
        .padding(0.1);

      // Declare the y (vertical position) scale.
      const y = d3
        .scaleLinear()
        .domain([0, d3.max(data, (d) => d[1])]) // Swap index 0 with index 1
        .range([height - marginBottom, marginTop]);

      // Create the SVG container.
      const svg = d3
        .create("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("viewBox", [0, 0, width, height])
        .attr("style", "max-width: 100%; height: auto;");

      // Add a rect for each bar.
      svg
        .append("g")
        .attr("fill", "black")
        .selectAll()
        .data(data)
        .join("rect")
        .attr("x", (d) => x(d[0])) // Swap index 1 with index 
        .attr("y", (d) => y(d[1])) // Swap index 0 with index 1
        .attr("height", (d) => y(0) - y(d[1])) // Swap index 0 with index 1
        .attr("width", x.bandwidth());

      // Add the x-axis and label.
      svg
        .append("g")
        .attr("transform", `translate(0,${height - marginBottom})`)
        .call(d3.axisBottom(x).tickSizeOuter(0))
        .attr("transorm", "180")

      // Add the y-axis and label, and remove the domain line.
      svg
        .append("g")
        .attr("transform", `translate(${marginLeft},0)`)
        .call(d3.axisLeft(y).tickFormat((y) => (y * 100).toFixed()))
        .call((g) => g.select(".domain").remove())
        .call((g) =>
          g
            .append("text")
            .attr("x", -marginLeft)
            .attr("y", 10)
            .attr("fill", "currentColor")
            .attr("text-anchor", "start")
            .attr("translate" , "180")
            .text("American GPD ")
        );

      // Append the SVG to the container element.
      document.getElementById("container").appendChild(svg.node());
    });
  </script>
</html>